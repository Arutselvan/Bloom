{% extends 'qa/base.html' %}
{% load django_markdown %}

{% block content %}

  {% if message %}
  <strong>Enter a valid Question!</strong>
  {% endif %}

  <form method="post" enctype="multipart/form-data" action="{% block action_url %}{% url 'qa_create_question' %}{% endblock action_url %}">
    {{ form.as_p }}
    {% csrf_token %}
    <button type="button" class="btn btn-info" onclick="getDescriptionFromAudio()">
      Get description from audio lecture
      <img id="recording-gif" style="display: none" src="/static/images/recording.gif" width="25px" height="25px"/>
    </button>
    <input class="btn pull-right btn-success" type="submit" value="Submit Question" />
  </form>

</div>

{% endblock content %}

{% block extra_js %}
  {% markdown_editor "#id_description" %}
  {% markdown_media %}
  <script type="text/javascript">
    
    function getDescriptionFromAudio() {
      const recognition = new window.webkitSpeechRecognition();

      recognition.onresult = (event) => {
        const speechToText = event.results[0][0].transcript;
        document.getElementById('recording-gif').style.display = 'none';
        document.getElementById('id_description').value = speechToText;
        recognition.stop();
      }
      document.getElementById('recording-gif').style.display = 'block';
      recognition.start();
    }
  </script>
{% endblock extra_js %}
